# finalProjectML

рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў:
train.csv: рЃДрЃЮрЃЋрЃћрЃџрЃЎрЃЋрЃўрЃарЃћрЃБрЃџрЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў 2010-рЃЊрЃљрЃю to 2012-рЃЏрЃЊрЃћ.

test.csv: рЃАрЃљрЃбрЃћрЃАрЃбрЃЮ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў.

features.csv: рЃерЃћрЃЏрЃЊрЃћрЃњрЃў рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃў рЃўрЃюрЃцрЃЮрЃарЃЏрЃљрЃфрЃўрЃљ: рЃбрЃћрЃЏрЃърЃћрЃарЃљрЃбрЃБрЃарЃљ, рЃЉрЃћрЃюрЃќрЃўрЃюрЃўрЃА рЃцрЃљрЃАрЃў, CPI(The Consumer Price Index), рЃБрЃЏрЃБрЃерЃћрЃЋрЃарЃЮрЃЉрЃљ, рЃцрЃљрЃАрЃЊрЃљрЃЎрЃџрЃћрЃЉрЃћрЃЉрЃў, рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃў

stores.csv: рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃў рЃўрЃюрЃцрЃЮрЃарЃЏрЃљрЃфрЃўрЃљ рЃДрЃЋрЃћрЃџрЃљ рЃЏрЃљрЃдрЃљрЃќрЃўрЃљрЃќрЃћ: рЃЏрЃљрЃдрЃљрЃќрЃўрЃўрЃА рЃбрЃўрЃърЃћрЃЉрЃў рЃЊрЃљ рЃќрЃЮрЃЏрЃћрЃЉрЃў.

sampleSubmission.csv: рЃАрЃљрЃЉрЃЏрЃўрЃерЃћрЃюрЃўрЃА рЃцрЃЮрЃарЃЏрЃљрЃбрЃў.

## Exploratory Data Analysis (EDA)
<img width="1243" height="496" alt="image" src="https://github.com/user-attachments/assets/fa3ff40c-afa2-463d-ad21-7a79c963de20" />

### Key Findings and Patterns

#### 1. рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃњрЃљрЃюрЃљрЃгрЃўрЃџрЃћрЃЉрЃљ
- **рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃў**: рЃфрЃљрЃџрЃАрЃљрЃ«рЃљ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃърЃўрЃЎрЃћрЃЉрЃў рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЊрЃўрЃЊ рЃњрЃљрЃЋрЃџрЃћрЃюрЃљрЃА рЃљрЃ«рЃЊрЃћрЃюрЃА рЃДрЃЮрЃЋрЃћрЃџрЃЎрЃЋрЃўрЃарЃћрЃБрЃџ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃќрЃћ
- **рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃўрЃА рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃњрЃљрЃЋрЃџрЃћрЃюрЃљ**: рЃюрЃЮрЃћрЃЏрЃЉрЃћрЃарЃў-рЃЊрЃћрЃЎрЃћрЃЏрЃЉрЃарЃўрЃА рЃърЃћрЃарЃўрЃЮрЃЊрЃерЃў рЃфрЃљрЃџрЃАрЃљрЃ«рЃљ рЃърЃўрЃЎрЃА рЃЋрЃ«рЃћрЃЊрЃљрЃЋрЃЌ
- **рЃДрЃЮрЃЋрЃћрЃџрЃгрЃџрЃўрЃБрЃарЃў рЃбрЃарЃћрЃюрЃЊрЃћрЃЉрЃў**: рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў рЃерЃБрЃљ рЃгрЃћрЃџрЃерЃў рЃЏрЃфрЃўрЃарЃЊрЃћрЃЉрЃљ рЃЊрЃљ рЃгрЃџрЃўрЃА рЃЉрЃЮрЃџрЃЮрЃА, рЃљрЃарЃЊрЃљрЃЊрЃћрЃњрЃћрЃЉрЃўрЃА рЃърЃћрЃарЃўрЃЮрЃЊрЃерЃў рЃўрЃќрЃарЃЊрЃћрЃЉрЃљ
<img width="1243" height="496" alt="image" src="https://github.com/user-attachments/assets/05bd2140-198f-4264-91a8-a0c1c203b850" />

#### 2. рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃўрЃА рЃърЃћрЃарЃцрЃЮрЃарЃЏрЃљрЃюрЃАрЃў
- **рЃЏрЃљрЃдрЃљрЃќрЃўрЃўрЃА рЃбрЃўрЃърЃћрЃЉрЃў**: A рЃбрЃўрЃърЃўрЃА рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃў рЃАрЃљрЃерЃБрЃљрЃџрЃЮрЃЊ рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЊрЃўрЃЊ рЃерЃћрЃЏрЃЮрЃАрЃљрЃЋрЃљрЃџрЃА рЃюрЃљрЃ«рЃБрЃџрЃЮрЃЉрЃћрЃю
- **рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃўрЃА рЃќрЃЮрЃЏрЃљрЃАрЃЌрЃљрЃю рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃљ**: рЃЊрЃўрЃЊрЃў рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃў рЃЏрЃћрЃб рЃерЃћрЃЏрЃЮрЃАрЃљрЃЋрЃљрЃџрЃА рЃўрЃдрЃћрЃЉрЃћрЃю, рЃЌрЃБрЃЏрЃфрЃљ рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃўрЃЌ рЃюрЃљрЃЎрЃџрЃћрЃЉрЃў рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃљ рЃљрЃЦрЃЋрЃЌ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃќрЃарЃЊрЃљрЃАрЃЌрЃљрЃю
<img width="577" height="459" alt="image" src="https://github.com/user-attachments/assets/2b8f97bc-caee-4007-818b-b6959f8d4344" />

<img width="904" height="556" alt="image" src="https://github.com/user-attachments/assets/6a982b29-4635-49b0-95cb-798b28c77b6f" />

#### 3. рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃћрЃЉрЃўрЃА рЃбрЃарЃћрЃюрЃЊрЃћрЃЉрЃў
- **рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃЏрЃљрЃдрЃљрЃџрЃў рЃЎрЃЮрЃюрЃфрЃћрЃюрЃбрЃарЃљрЃфрЃўрЃљ**: рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЏрЃћ рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃў рЃЊрЃЮрЃЏрЃўрЃюрЃўрЃарЃћрЃЉрЃА рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃЏрЃЮрЃфрЃБрЃџрЃЮрЃЉрЃўрЃЌ
- **Department Variability**: Activity across departments varies significantly and shows seasonal patterns
- **Performance Patterns**: Different departments exhibit unique seasonal behaviors and sales cycles
<img width="998" height="560" alt="image" src="https://github.com/user-attachments/assets/1d75d591-832b-4460-8e46-3904e1db2a24" />

#### 4. Holiday and Markdown Effects
- **рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃўрЃА рЃњрЃљрЃЋрЃџрЃћрЃюрЃљ**: рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃА рЃЊрЃўрЃЊрЃў рЃњрЃљрЃЋрЃџрЃћрЃюрЃљ рЃљрЃЦрЃЋрЃА рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃќрЃћ
- **рЃцрЃљрЃАрЃЊрЃљрЃЎрЃџрЃћрЃЉрЃћрЃЉрЃўрЃА рЃњрЃљрЃЋрЃџрЃћрЃюрЃљ**: рЃцрЃљрЃАрЃЊрЃљрЃЎрЃџрЃћрЃЉрЃћрЃЉрЃА рЃЊрЃљрЃЊрЃћрЃЉрЃўрЃЌрЃў рЃњрЃљрЃЋрЃџрЃћрЃюрЃљ рЃљрЃЦрЃЋрЃА рЃќрЃЮрЃњ рЃЎрЃЋрЃўрЃарЃљрЃерЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃќрЃћ
- **рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃърЃўрЃЎрЃћрЃЉрЃў**: рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃў рЃњрЃљрЃДрЃЮрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃърЃўрЃЎрЃћрЃЉрЃА рЃЦрЃЏрЃюрЃўрЃљрЃю 
<img width="724" height="621" alt="image" src="https://github.com/user-attachments/assets/da02aa87-b546-40e4-a145-5a4465aeccb2" />
<img width="577" height="487" alt="image" src="https://github.com/user-attachments/assets/79911c33-22b1-407d-b1e6-dcf2660402ae" />

#### 5. рЃћрЃЎрЃЮрЃюрЃЮрЃЏрЃўрЃЎрЃБрЃарЃў рЃцрЃљрЃЦрЃбрЃЮрЃарЃћрЃЉрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃЮ
- **рЃюрЃљрЃЎрЃџрЃћрЃЉрЃў рЃњрЃљрЃЋрЃџрЃћрЃюрЃљ**: CPI, рЃАрЃљрЃгрЃЋрЃљрЃЋрЃўрЃА рЃцрЃљрЃАрЃА, рЃЊрЃљ рЃБрЃЏрЃБрЃерЃћрЃЋрЃарЃЮрЃЉрЃљрЃА рЃЏрЃўрЃюрЃўрЃЏрЃљрЃџрЃБрЃарЃўрЃћрЃцрЃћрЃЦрЃбрЃў рЃљрЃЦрЃЋрЃА
- **рЃЎрЃЮрЃарЃћрЃџрЃљрЃќрЃўрЃљ**: рЃћрЃЎрЃЮрЃюрЃЮрЃЏрЃўрЃЎрЃБрЃа рЃўрЃюрЃЊрЃўрЃЎрЃљрЃбрЃЮрЃарЃћрЃЉрЃА рЃФрЃљрЃџрЃўрЃљрЃю рЃАрЃБрЃАрЃбрЃў рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃљ рЃљрЃЦрЃЋрЃЌ рЃДрЃЮрЃЋрЃћрЃџрЃЎрЃЋрЃўрЃарЃћрЃБрЃџ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃЌрЃљрЃю
- **рЃбрЃћрЃЏрЃърЃћрЃарЃљрЃбрЃБрЃарЃљ**: рЃћрЃЦрЃАрЃбрЃарЃћрЃЏрЃљрЃџрЃБрЃа рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃќрЃћ рЃАрЃљрЃерЃБрЃљрЃџрЃЮ рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃљ рЃљрЃЦрЃЋрЃА


#### 7. Time Series Characteristics
- **рЃљрЃЋрЃбрЃЮрЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃљ**: рЃљрЃЋрЃбрЃЮрЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃўрЃА рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃў рЃўрЃЏрЃљрЃА рЃЏрЃўрЃБрЃЌрЃўрЃЌрЃћрЃЉрЃА, рЃарЃЮрЃЏ рЃБрЃљрЃ«рЃџрЃЮрЃћрЃАрЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃўрЃљ рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА, рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃњрЃљрЃЏрЃЮрЃАрЃљрЃЊрЃћрЃњрЃў рЃўрЃЦрЃюрЃћрЃЉрЃљ рЃџрЃћрЃњ рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃў. 
- **рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃљ**: рЃфрЃљрЃџрЃАрЃљрЃ«рЃљ рЃЎрЃЋрЃўрЃарЃћрЃБрЃџрЃў рЃЊрЃљ рЃЌрЃЋрЃўрЃБрЃарЃў рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃўрЃљ рЃЊрЃљрЃбрЃљрЃАрЃћрЃбрЃерЃў
<img width="577" height="467" alt="image" src="https://github.com/user-attachments/assets/87a5e0ce-b77c-4caf-a684-a81b829aec3c" />
<img width="623" height="464" alt="image" src="https://github.com/user-attachments/assets/b420cc42-d0c9-49c2-a171-38183b492a71" />

#### 8. Feature Correlation Analysis
- **рЃљрЃдрЃАрЃљрЃюрЃўрЃерЃюрЃљрЃЋрЃў рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃћрЃЉрЃў**: рЃЏрЃљрЃдрЃљрЃќрЃўрЃўрЃА рЃбрЃўрЃърЃў,рЃќрЃЮрЃЏрЃљ, рЃЊрЃљ рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃў
- **рЃАрЃБрЃАрЃбрЃў рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃћрЃЉрЃў**: рЃћрЃЎрЃЮрЃюрЃЮрЃЏрЃўрЃЎрЃБрЃарЃў рЃўрЃюрЃЊрЃўрЃЎрЃљрЃбрЃЮрЃарЃћрЃЉрЃў (CPI, рЃБрЃЏрЃБрЃерЃћрЃЋрЃарЃЮрЃЉрЃљ, рЃАрЃљрЃгрЃЋрЃљрЃЋрЃўрЃА рЃцрЃљрЃАрЃў) 
- **рЃцрЃљрЃАрЃЊрЃљрЃЎрЃџрЃћрЃЉрЃўрЃА рЃћрЃцрЃћрЃЦрЃбрЃў**: рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃцрЃљрЃАрЃЊрЃљрЃЎрЃџрЃћрЃЉрЃћрЃЉрЃўрЃА рЃбрЃўрЃърЃћрЃЉрЃў рЃАрЃ«рЃЋрЃљрЃљрЃАрЃ«рЃЋрЃљ рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃљрЃерЃў рЃЏрЃЮрЃЊрЃўрЃљрЃю рЃњрЃљрЃДрЃЮрЃЊрЃЋрЃћрЃЉрЃЌрЃљрЃю
<img width="1983" height="1226" alt="image" src="https://github.com/user-attachments/assets/210543d8-682c-44ce-85ec-0677dd119ade" />


# finalProjectML
рЃћрЃА рЃърЃарЃЮрЃћрЃЦрЃбрЃў рЃЏрЃўрЃќрЃюрЃљрЃЊ рЃўрЃАрЃљрЃ«рЃљрЃЋрЃА рЃгрЃўрЃюрЃљрЃАрЃгрЃљрЃарЃЏрЃћрЃбрЃДрЃЋрЃћрЃџрЃћрЃЉрЃљрЃА рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃўрЃА рЃДрЃЮрЃЋрЃћрЃџрЃЎрЃЋрЃўрЃарЃћрЃБрЃџрЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃЏрЃЮрЃфрЃБрЃџрЃЮрЃЉрЃљрЃќрЃћ, РђъWalmart Recruiting - Store Sales ForecastingРђю рЃЎрЃљрЃњрЃџрЃўрЃА рЃЎрЃЮрЃюрЃЎрЃБрЃарЃАрЃўрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃќрЃћ рЃЊрЃљрЃДрЃарЃЊрЃюрЃЮрЃЉрЃўрЃЌ.
рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃБрЃџрЃў рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃћрЃЉрЃў
DLinear, RandomForestRegressor, LightGBM, XGBOOST, N-BEATS, ARIMA, Prophet

рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў:
train.csv: рЃДрЃЮрЃЋрЃћрЃџрЃЎрЃЋрЃўрЃарЃћрЃБрЃџрЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў 2010-рЃЊрЃљрЃю to 2012-рЃЏрЃЊрЃћ.

test.csv: рЃАрЃљрЃбрЃћрЃАрЃбрЃЮ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў.

features.csv: рЃерЃћрЃЏрЃЊрЃћрЃњрЃў рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃў рЃўрЃюрЃцрЃЮрЃарЃЏрЃљрЃфрЃўрЃљ: рЃбрЃћрЃЏрЃърЃћрЃарЃљрЃбрЃБрЃарЃљ, рЃЉрЃћрЃюрЃќрЃўрЃюрЃўрЃА рЃцрЃљрЃАрЃў, CPI(The Consumer Price Index), рЃБрЃЏрЃБрЃерЃћрЃЋрЃарЃЮрЃЉрЃљ, рЃцрЃљрЃАрЃЊрЃљрЃЎрЃџрЃћрЃЉрЃћрЃЉрЃў, рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃў

stores.csv: рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃў рЃўрЃюрЃцрЃЮрЃарЃЏрЃљрЃфрЃўрЃљ рЃДрЃЋрЃћрЃџрЃљ рЃЏрЃљрЃдрЃљрЃќрЃўрЃљрЃќрЃћ: рЃЏрЃљрЃдрЃљрЃќрЃўрЃўрЃА рЃбрЃўрЃърЃћрЃЉрЃў рЃЊрЃљ рЃќрЃЮрЃЏрЃћрЃЉрЃў.

sampleSubmission.csv: рЃАрЃљрЃЉрЃЏрЃўрЃерЃћрЃюрЃўрЃА рЃцрЃЮрЃарЃЏрЃљрЃбрЃў.

Exploratory Data Analysis (EDA)

рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЏрЃћ рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў рЃърЃљрЃбрЃћрЃарЃюрЃў:

рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃњрЃљрЃюрЃљрЃгрЃўрЃџрЃћрЃЉрЃљ:

рЃДрЃЮрЃЋрЃћрЃџрЃЎрЃЋрЃўрЃарЃћрЃБрЃџ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃќрЃћ рЃБрЃЊрЃўрЃЊрЃћрЃА рЃњрЃљрЃЋрЃџрЃћрЃюрЃљрЃА рЃљрЃ«рЃЊрЃћрЃюрЃА рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃърЃўрЃЎрЃћрЃЉрЃў.

рЃфрЃљрЃџрЃАрЃљрЃ«рЃљ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃърЃўрЃЎрЃћрЃЉрЃўрЃљ рЃюрЃЮрЃћрЃЏрЃЉрЃћрЃарЃў-рЃЊрЃћрЃЎрЃћрЃЏрЃЉрЃарЃўрЃА рЃърЃћрЃарЃўрЃЮрЃЊрЃерЃў.

рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў рЃЏрЃфрЃўрЃарЃЊрЃћрЃЉрЃљ рЃгрЃћрЃџрЃўрЃгрЃљрЃЊрЃўрЃА рЃерЃБрЃљрЃерЃў рЃЊрЃљ рЃўрЃќрЃарЃЊрЃћрЃЉрЃљ рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃќрЃћ.

рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃў:

A рЃбрЃўрЃърЃўрЃА рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃў рЃАрЃљрЃерЃБрЃљрЃџрЃЮрЃЊ рЃЏрЃћрЃб рЃерЃћрЃЏрЃЮрЃАрЃљрЃЋрЃљрЃџрЃА рЃўрЃдрЃћрЃЉрЃА.

рЃБрЃцрЃарЃЮ рЃЊрЃўрЃЊрЃў рЃЏрЃљрЃдрЃљрЃќрЃўрЃћрЃЉрЃў рЃюрЃљрЃЎрЃџрЃћрЃЉрЃљрЃЊ рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃљрЃерЃљ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃќрЃарЃЊрЃљрЃАрЃЌрЃљрЃю.

рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃћрЃЉрЃўрЃА рЃбрЃарЃћрЃюрЃЊрЃћрЃЉрЃў:

рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃерЃў рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЏрЃћ рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃў рЃЊрЃЮрЃЏрЃўрЃюрЃўрЃарЃћрЃЉрЃА.

рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃћрЃЉрЃерЃў рЃљрЃЦрЃбрЃўрЃЋрЃЮрЃЉрЃљ рЃћрЃарЃЌрЃЏрЃљрЃюрЃћрЃЌрЃўрЃАрЃњрЃљрЃю рЃњрЃљрЃюрЃАрЃ«рЃЋрЃљрЃЋрЃћрЃЉрЃБрЃџрЃў рЃЊрЃљ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃўрЃљ.

рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃў рЃЊрЃљ рЃцрЃљрЃАрЃЊрЃљрЃЎрЃџрЃћрЃЉрЃћрЃЉрЃў:

рЃЊрЃдрЃћрЃАрЃљрЃАрЃгрЃљрЃБрЃџрЃћрЃЉрЃўрЃА рЃърЃћрЃарЃўрЃЮрЃЊрЃерЃў рЃфрЃљрЃџрЃАрЃљрЃ«рЃљрЃЊ рЃЏрЃћрЃбрЃўрЃљ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў.

рЃцрЃљрЃАрЃЊрЃљрЃЎрЃџрЃћрЃЉрЃћрЃЉрЃў рЃќрЃЮрЃњрЃўрЃћрЃарЃЌ рЃЎрЃЋрЃўрЃарЃљрЃерЃў рЃЊрЃљрЃЊрЃћрЃЉрЃўрЃЌ рЃњрЃљрЃЋрЃџрЃћрЃюрЃљрЃА рЃљрЃЋрЃџрЃћрЃюрЃА рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃќрЃћ.

рЃћрЃЎрЃЮрЃюрЃЮрЃЏрЃўрЃЎрЃБрЃарЃў рЃюрЃљрЃгрЃўрЃџрЃў:

CPI, рЃЉрЃћрЃюрЃќрЃўрЃюрЃўрЃА рЃцрЃљрЃАрЃў, рЃЊрЃљ рЃБрЃЏрЃБрЃерЃћрЃЋрЃарЃЮрЃЉрЃљ рЃЊрЃўрЃЊрЃљрЃЊ рЃњрЃљрЃЋрЃџрЃћрЃюрЃљрЃА рЃљрЃа рЃљрЃ«рЃЊрЃћрЃюрЃА рЃДрЃЮрЃЋрЃћрЃџрЃЎрЃЋрЃўрЃарЃћрЃБрЃџ рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃќрЃћ.


# 1. RANDOMFORESTREGRESSOR

 # рЃАрЃљрЃЏрЃБрЃерЃљрЃЮ рЃюрЃљрЃЉрЃўрЃ»рЃћрЃЉрЃў
рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃЕрЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃљ рЃЊрЃљ рЃњрЃљрЃгрЃЏрЃћрЃюрЃЊрЃљ

рЃЕрЃљрЃбрЃЋрЃўрЃарЃЌрЃБрЃџрЃўрЃљ train.csv, test.csv, features.csv, stores.csv

рЃњрЃљрЃћрЃарЃЌрЃўрЃљрЃюрЃЊрЃљ рЃДрЃЋрЃћрЃџрЃљ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃў Store рЃЊрЃљ Date рЃАрЃЋрЃћрЃбрЃћрЃЉрЃќрЃћ

рЃЌрЃљрЃарЃўрЃдрЃўрЃЊрЃљрЃю рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃџрЃўрЃџрЃўрЃљ рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃўрЃЌрЃў рЃАрЃЋрЃћрЃбрЃћрЃЉрЃў: Year, Month, Week

рЃфрЃљрЃарЃўрЃћрЃџрЃў рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃћрЃЉрЃў (Markdown рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃерЃў) рЃЕрЃљрЃюрЃљрЃфрЃЋрЃџрЃЊрЃљ рЃюрЃБрЃџрЃћрЃЉрЃўрЃЌ

рЃЎрЃљрЃбрЃћрЃњрЃЮрЃарЃўрЃБрЃџрЃў рЃфрЃЋрЃџрЃљрЃЊрЃў Type рЃњрЃљрЃЊрЃљрЃЎрЃћрЃЌрЃЊрЃљ рЃарЃўрЃфрЃ«рЃЋрЃЮрЃЉрЃарЃўрЃЋрЃљрЃЊ (LabelEncoder-рЃўрЃЌ)

рЃбрЃарЃћрЃюрЃўрЃюрЃњ рЃЋрЃљрЃџрЃўрЃЊрЃљрЃфрЃўрЃўрЃА рЃњрЃљрЃДрЃЮрЃцрЃљ (Train-Test Split)

рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃњрЃљрЃгрЃЋрЃарЃЌрЃюрЃўрЃџрЃўрЃљ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА 80%-рЃќрЃћ

рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃБрЃџрЃўрЃљ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃЊрЃљрЃарЃЕрЃћрЃюрЃўрЃџ 20%-рЃќрЃћ

рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃљ Рђћ WMAE (Weighted Mean Absolute Error)

рЃерЃћрЃфрЃЊрЃЮрЃЏрЃўрЃА рЃЊрЃљрЃЌрЃЋрЃџрЃљ рЃўрЃЌрЃЋрЃљрЃџрЃўрЃАрЃгрЃўрЃюрЃћрЃЉрЃА IsHoliday рЃАрЃЋрЃћрЃбрЃА: рЃљрЃарЃЊрЃљрЃЊрЃћрЃњрЃћрЃЉрЃўрЃА рЃЎрЃЋрЃўрЃарЃћрЃЉрЃў 5-рЃ»рЃћрЃа рЃЏрЃћрЃб рЃгрЃЮрЃюрЃљрЃА рЃўрЃФрЃџрЃћрЃЋрЃљ

рЃЏрЃўрЃдрЃћрЃЉрЃБрЃџрЃў рЃерЃћрЃцрЃљрЃАрЃћрЃЉрЃљ рЃњрЃЋрЃўрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА, рЃарЃљрЃЏрЃЊрЃћрЃюрЃљрЃЊ рЃЎрЃљрЃарЃњрЃљрЃЊ рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃарЃћрЃљрЃџрЃБрЃа рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃА

# рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃњрЃљрЃЊрЃљрЃЏрЃќрЃљрЃЊрЃћрЃЉрЃљ рЃЊрЃљ рЃцрЃўрЃюрЃљрЃџрЃБрЃарЃў рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃљ

рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃњрЃљрЃЊрЃљрЃЏрЃќрЃљрЃЊрЃЊрЃљ рЃАрЃарЃБрЃџ train рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃќрЃћ

рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃћрЃЉрЃў рЃњрЃљрЃЏрЃЮрЃЌрЃЋрЃџрЃўрЃџрЃўрЃљ test.csv рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃќрЃћ

# рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў
рЃЋрЃљрЃџрЃўрЃЊрЃљрЃфрЃўрЃљрЃќрЃћ рЃЏрЃўрЃдрЃћрЃЉрЃБрЃџрЃў WMAE рЃњрЃЋрЃўрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃџрЃЮрЃЉрЃћрЃЉрЃА рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃљрЃерЃў.

Random Forest рЃњрЃЌрЃљрЃЋрЃљрЃќрЃЮрЃЉрЃЌ рЃАрЃбрЃљрЃЉрЃўрЃџрЃБрЃа рЃерЃћрЃЊрЃћрЃњрЃА рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЏрЃћ рЃцрЃБрЃюрЃЦрЃфрЃўрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃўрЃЌ, рЃДрЃЮрЃЋрЃћрЃџрЃњрЃЋрЃљрЃарЃў рЃарЃЌрЃБрЃџрЃў рЃбрЃўрЃБрЃюрЃўрЃюрЃњрЃўрЃА рЃњрЃљрЃарЃћрЃерЃћ.

# 2. ARIMA
### Feature Engineering
- **рЃЊрЃарЃЮрЃўрЃА рЃЏрЃљрЃ«рЃљрЃАрЃўрЃљрЃЌрЃћрЃЉрЃџрЃћрЃЉрЃў:** Month, Week, DayOfYear
- **Store-Department рЃАрЃбрЃљрЃбрЃўрЃАрЃбрЃўрЃЎрЃљ:** Sales_Mean, Sales_Std, Sales_Median, Sales_Min, Sales_Max
- **рЃњрЃљрЃарЃћ рЃцрЃљрЃЦрЃбрЃЮрЃарЃћрЃЉрЃў:** Temperature, Fuel_Price, CPI, Unemployment
- **рЃљрЃарЃЊрЃљрЃЊрЃћрЃњрЃћрЃЉрЃўрЃА рЃЏрЃБрЃџрЃбрЃўрЃърЃџрЃўрЃЎрЃљрЃбрЃЮрЃарЃћрЃЉрЃў:** Store-Department рЃАрЃърЃћрЃфрЃўрЃцрЃўрЃБрЃџрЃў рЃЊрЃљ рЃњрЃџрЃЮрЃЉрЃљрЃџрЃБрЃарЃў

### Data Splitting
- **Training:** 2010-02-05 to 2012-07-27
- **Validation:** 2012-08-03 to 2012-10-26 (13 рЃЎрЃЋрЃўрЃарЃљ)
- **Grouping:** Store-Department рЃЎрЃЮрЃЏрЃЉрЃўрЃюрЃљрЃфрЃўрЃћрЃЉрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ

##  ARIMA рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃўрЃА рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ

### рЃарЃљрЃбрЃЮрЃЏ ARIMA?
ARIMA рЃљрЃўрЃарЃЕрЃљ рЃарЃљрЃЊрЃњрЃљрЃю:
- **Time Series рЃЉрЃБрЃюрЃћрЃЉрЃљ:** рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў рЃЊрЃарЃЮрЃерЃў рЃЊрЃљрЃЏрЃЮрЃЎрЃўрЃЊрЃћрЃЉрЃБрЃџрЃўрЃљ
- **Trend рЃЊрЃљ Seasonality:** ARIMA рЃБрЃЏрЃЎрЃџрЃљрЃЋрЃЊрЃћрЃЉрЃљ рЃбрЃћрЃюрЃЊрЃћрЃюрЃфрЃўрЃљрЃА рЃЊрЃљ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃљрЃА
- **рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃА рЃўрЃюрЃбрЃћрЃарЃърЃарЃћрЃбрЃљрЃфрЃўрЃљ:** p,d,q рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў рЃЏрЃљрЃарЃбрЃўрЃЋрЃљрЃЊ рЃњрЃљрЃАрЃљрЃњрЃћрЃЉрЃўрЃљ

### 1) Simple ARIMA (WMAE: 2213.76)
```python
# рЃЉрЃљрЃќрЃБрЃарЃў ARIMA(1,1,1) рЃДрЃЋрЃћрЃџрЃљ Store-Dept-рЃќрЃћ
model = ARIMA(ts, order=(1, 1, 1))
# рЃњрЃџрЃЮрЃЉрЃљрЃџрЃБрЃарЃў рЃљрЃарЃЊрЃљрЃЊрЃћрЃњрЃћрЃЉрЃўрЃА рЃЏрЃБрЃџрЃбрЃўрЃърЃџрЃўрЃЎрЃљрЃбрЃЮрЃарЃў: 1.074
```

**рЃЏрЃБрЃерЃљрЃЮрЃЉрЃўрЃА рЃърЃарЃўрЃюрЃфрЃўрЃърЃў:**
- рЃЏрЃўрЃюрЃўрЃЏрЃБрЃЏ 10 рЃЊрЃљрЃЎрЃЋрЃўрЃарЃЋрЃћрЃЉрЃљ Store-Dept-рЃќрЃћ
- Weekly aggregation
- Fallback: Store-Dept рЃАрЃљрЃерЃБрЃљрЃџрЃЮ

### 2) Optimized ARIMA (WMAE: 2550.43)
```python
# рЃЏрЃарЃљрЃЋрЃљрЃџрЃў ARIMA рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃўрЃА рЃбрЃћрЃАрЃбрЃўрЃарЃћрЃЉрЃљ
configs = [(1,1,1), (2,1,1), (1,1,2), (0,1,1), (1,0,1), (2,1,2)]
# AIC-рЃўрЃЌ рЃАрЃљрЃБрЃЎрЃћрЃЌрЃћрЃАрЃЮ рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃљрЃарЃЕрЃћрЃЋрЃљ
```

**рЃњрЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃћрЃЉрЃћрЃЉрЃў:**
- Store-Dept рЃАрЃърЃћрЃфрЃўрЃцрЃўрЃБрЃџрЃў рЃљрЃарЃЊрЃљрЃЊрЃћрЃњрЃћрЃЉрЃўрЃА рЃЏрЃБрЃџрЃбрЃўрЃърЃџрЃўрЃЎрЃљрЃбрЃЮрЃарЃћрЃЉрЃў
- рЃбрЃћрЃЏрЃърЃћрЃарЃљрЃбрЃБрЃарЃўрЃА рЃЎрЃЮрЃарЃћрЃЦрЃбрЃўрЃарЃћрЃЉрЃљ (>80┬░C: 0.95x, <30┬░C: 1.05x)
- рЃЏрЃўрЃюрЃўрЃЏрЃБрЃЏ 15 рЃЊрЃљрЃЎрЃЋрЃўрЃарЃЋрЃћрЃЉрЃљ

### 3) Fast Optimized ARIMA (WMAE: 2152.64)
```python
# рЃерЃћрЃЏрЃфрЃўрЃарЃћрЃЉрЃБрЃџрЃў рЃЎрЃЮрЃюрЃцрЃўрЃњрЃБрЃарЃљрЃфрЃўрЃћрЃЉрЃў рЃАрЃгрЃарЃљрЃцрЃў рЃЮрЃърЃбрЃўрЃЏрЃўрЃќрЃљрЃфрЃўрЃўрЃАрЃЌрЃЋрЃўрЃА
configs = [(1,1,1), (2,1,1), (1,1,2)]
# рЃбрЃћрЃЏрЃърЃћрЃарЃљрЃбрЃБрЃарЃўрЃА рЃюрЃљрЃЎрЃџрЃћрЃЉрЃў рЃњрЃљрЃЋрЃџрЃћрЃюрЃљ (0.98x, 1.02x)
```

**рЃЮрЃърЃбрЃўрЃЏрЃўрЃќрЃљрЃфрЃўрЃћрЃЉрЃў:**
- рЃЏрЃўрЃюрЃўрЃЏрЃБрЃЏ 12 рЃЊрЃљрЃЎрЃЋрЃўрЃарЃЋрЃћрЃЉрЃљ
- 80% recent + 20% overall average fallback
- рЃАрЃгрЃарЃљрЃцрЃў рЃърЃарЃЮрЃфрЃћрЃАрЃўрЃюрЃњрЃў

##  WMAE рЃЏрЃћрЃбрЃарЃўрЃЎрЃљ

```python
def compute_wmae(y_true, y_pred, is_holiday):
    weights = np.where(is_holiday, 5, 1)  # рЃљрЃарЃЊрЃљрЃЊрЃћрЃњрЃћрЃЉрЃќрЃћ 5x рЃгрЃЮрЃюрЃљ
    return np.sum(weights * np.abs(y_true - y_pred)) / np.sum(weights)
```

# Deep Learning

## N-BEATS

Рђб рЃДрЃЋрЃћрЃџрЃљ (store, dept) рЃЎрЃЮрЃЏрЃЉрЃўрЃюрЃљрЃфрЃўрЃљрЃА рЃљрЃЦрЃЋрЃА рЃЌрЃљрЃЋрЃўрЃАрЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃўрЃА рЃърЃљрЃбрЃћрЃарЃюрЃў, рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃерЃћрЃЋрЃЦрЃЏрЃћрЃюрЃўрЃЌ рЃБрЃюрЃўрЃЎрЃљрЃџрЃБрЃарЃў рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃДрЃЮрЃЋрЃћрЃџрЃў рЃгрЃДрЃЋрЃўрЃџрЃўрЃАрЃЌрЃЋрЃўрЃА.

Рђб рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў рЃЊрЃљрЃЋрЃбрЃЋрЃўрЃарЃЌрЃћрЃЌ рЃўрЃАрЃћ, рЃарЃЮрЃЏ рЃЦрЃарЃЮрЃюрЃЮрЃџрЃЮрЃњрЃўрЃБрЃарЃљрЃЊ рЃАрЃгрЃЮрЃарЃў рЃДрЃЮрЃцрЃўрЃџрЃўрЃДрЃЮ, рЃарЃљрЃЊрЃњрЃљрЃю рЃћрЃА N-BEATS-рЃўрЃАрЃЌрЃЋрЃўрЃА рЃљрЃБрЃфрЃўрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ. N-BEATS рЃљрЃа рЃАрЃљрЃГрЃўрЃарЃЮрЃћрЃЉрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃњрЃљрЃгрЃЏрЃћрЃюрЃЊрЃљрЃА (NaN-рЃћрЃЉрЃўрЃА рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљ), feature engineering-рЃА рЃљрЃю рЃАрЃ«рЃЋрЃљ preprocessing-рЃўрЃА рЃърЃарЃЮрЃфрЃћрЃАрЃћрЃЉрЃА, рЃарЃљрЃЊрЃњрЃљрЃю рЃўрЃА рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃгрЃљрЃарЃАрЃБрЃџ weekly_sales-рЃўрЃА рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃА рЃўрЃДрЃћрЃюрЃћрЃЉрЃА рЃЏрЃЮрЃЏрЃљрЃЋрЃџрЃўрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА.

Рђб test/validation - 70/30

| рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃў | рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ | рЃљрЃдрЃгрЃћрЃарЃљ |
|----------|-------------|--------|
| h | 4 | рЃЏрЃЮрЃЏрЃљрЃЋрЃљрЃџрЃў рЃЊрЃарЃЮрЃўрЃА рЃюрЃљрЃЉрЃўрЃ»рЃћрЃЉрЃўрЃА рЃарЃљрЃЮрЃЊрЃћрЃюрЃЮрЃЉрЃљ рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА (рЃЏрЃљрЃњ., рЃерЃћрЃЏрЃЊрЃћрЃњрЃў 4 рЃЎрЃЋрЃўрЃарЃљ). |
| input_size | 24 | рЃарЃљрЃЏрЃЊрЃћрЃюрЃў рЃгрЃљрЃарЃАрЃБрЃџрЃў рЃЊрЃарЃЮрЃўрЃА рЃюрЃљрЃЉрЃўрЃ»рЃў рЃњрЃљрЃЏрЃЮрЃўрЃДрЃћрЃюрЃћрЃЉрЃљ рЃЏрЃЮрЃЏрЃљрЃЋрЃџрЃўрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА. |
| start_padding_enabled | True | рЃАрЃљрЃерЃБрЃљрЃџрЃћрЃЉрЃљрЃА рЃљрЃФрЃџрЃћрЃЋрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃўрЃарЃћрЃЉрЃўрЃА рЃЊрЃљрЃгрЃДрЃћрЃЉрЃљрЃА рЃЏрЃљрЃерЃўрЃюрЃљрЃф рЃЎрЃў, рЃарЃЮрЃфрЃљ input_size 24-рЃќрЃћ рЃюрЃљрЃЎрЃџрЃћрЃЉрЃўрЃљ. |
| max_steps | 5000 | рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃўрЃА рЃўрЃбрЃћрЃарЃљрЃфрЃўрЃћрЃЉрЃўрЃА рЃЏрЃљрЃЦрЃАрЃўрЃЏрЃљрЃџрЃБрЃарЃў рЃќрЃдрЃЋрЃљрЃарЃў (рЃДрЃЋрЃћрЃџрЃљ batch-рЃерЃў). рЃћрЃА рЃќрЃдрЃЋрЃљрЃарЃў рЃљрЃа рЃюрЃўрЃерЃюрЃљрЃЋрЃА, рЃарЃЮрЃЏ рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃљрЃБрЃфрЃўрЃџрЃћрЃЉрЃџрЃљрЃЊ рЃЉрЃЮрЃџрЃЮрЃЏрЃЊрЃћ рЃўрЃЋрЃљрЃарЃ»рЃўрЃерЃћрЃЉрЃА. |
| batch_size | 128 | рЃћрЃарЃЌ step-рЃерЃў рЃћрЃарЃЌрЃљрЃЊ рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃБрЃџрЃў рЃЊрЃарЃЮрЃўрЃЌрЃў рЃАрЃћрЃарЃўрЃћрЃЉрЃўрЃА рЃарЃљрЃЮрЃЊрЃћрЃюрЃЮрЃЉрЃљ. рЃЊрЃўрЃЊрЃў batch-рЃћрЃЉрЃў (128) рЃБрЃцрЃарЃЮ рЃАрЃбрЃљрЃЉрЃўрЃџрЃБрЃа рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃћрЃЉрЃА рЃўрЃФрЃџрЃћрЃЋрЃљ, рЃЏрЃљрЃњрЃарЃљрЃЏ рЃЏрЃћрЃб рЃЏрЃћрЃ«рЃАрЃўрЃћрЃарЃћрЃЉрЃљрЃА рЃўрЃДрЃћрЃюрЃћрЃЉрЃА. |
| early_stop_patience_steps | 200 | рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃў рЃерЃћрЃЕрЃћрЃарЃЊрЃћрЃЉрЃљ, рЃЌрЃБ validation loss рЃљрЃа рЃњрЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃЊрЃћрЃЉрЃљ 200 рЃюрЃљрЃЉрЃўрЃ»рЃўрЃА рЃњрЃљрЃюрЃЏрЃљрЃЋрЃџрЃЮрЃЉрЃљрЃерЃў. |
| scaler_type | 'standard' | рЃюрЃЮрЃарЃЏрЃљрЃџрЃўрЃќрЃљрЃфрЃўрЃўрЃА рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃЏрЃљрЃ«рЃљрЃАрЃўрЃљрЃЌрЃћрЃЉрЃџрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА, рЃарЃљрЃф рЃћрЃ«рЃЏрЃљрЃарЃћрЃЉрЃљ рЃюрЃћрЃўрЃарЃЮрЃюрЃБрЃџ рЃЦрЃАрЃћрЃџрЃА рЃБрЃцрЃарЃЮ рЃАрЃгрЃарЃљрЃцрЃў рЃЊрЃљ рЃАрЃбрЃљрЃЉрЃўрЃџрЃБрЃарЃў рЃЎрЃЮрЃюрЃЋрЃћрЃарЃњрЃћрЃюрЃфрЃўрЃўрЃАрЃЌрЃЋрЃўрЃА. |
| val_check_steps | 100 | рЃарЃљрЃЏрЃЊрЃћрЃюрЃљрЃЊ рЃ«рЃерЃўрЃарЃљрЃЊ рЃљрЃцрЃљрЃАрЃћрЃЉрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃў validation-рЃА. |

**Validation WMAE: 1736.3801971897966**

## hyperparameter tuning

Рђб рЃњрЃљрЃЋрЃќрЃљрЃарЃЊрЃћ input size, рЃарЃљрЃЌрЃљ рЃЏрЃЮрЃЊрЃћрЃџрЃЏрЃљ рЃЏрЃћрЃбрЃў рЃгрЃљрЃарЃАрЃБрЃџрЃў рЃўрЃюрЃцрЃЮрЃарЃЏрЃљрЃфрЃўрЃљ рЃЏрЃўрЃўрЃдрЃЮрЃА рЃЊрЃљ рЃБрЃЎрЃћрЃЌ рЃљрЃЏрЃЮрЃўрЃфрЃюрЃЮрЃА рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃў.
Рђб рЃњрЃљрЃЋрЃќрЃљрЃарЃЊрЃћ training step рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃЎрЃЮрЃюрЃЋрЃћрЃарЃњрЃћрЃюрЃфрЃўрЃўрЃАрЃЌрЃЋрЃўрЃА.

Рђб рЃњрЃљрЃЋрЃќрЃљрЃарЃЊрЃћ batch_size рЃБрЃцрЃарЃЮ рЃАрЃбрЃљрЃЉрЃўрЃџрЃБрЃарЃў рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА.

Рђб рЃерЃћрЃЋрЃљрЃЏрЃфрЃўрЃарЃћ batch_size рЃБрЃцрЃарЃЮ рЃ«рЃерЃўрЃарЃў рЃњрЃљрЃюрЃљрЃ«рЃџрЃћрЃЉрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА.

Рђб рЃерЃћрЃЋрЃљрЃцрЃљрЃАрЃћ рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃАрЃЎрЃљрЃџрЃћрЃарЃћрЃЉрЃў, рЃЏрЃљрЃЌ рЃерЃЮрЃарЃўрЃА MinMax рЃЊрЃљ Robust Scaler.

рЃАрЃљрЃБрЃЎрЃћрЃЌрЃћрЃАрЃЮ рЃерЃћрЃЊрЃћрЃњрЃў RobustScaler-рЃЏрЃљ рЃљрЃЕрЃЋрЃћрЃюрЃљ, рЃарЃљрЃЊрЃњрЃљрЃю weekly_sales-рЃА рЃЉрЃћрЃЋрЃарЃў outlier рЃљрЃЦрЃЋрЃА. StandardScaler-рЃўрЃА рЃЊрЃарЃЮрЃА рЃћрЃА outlier-рЃћрЃЉрЃў рЃ«рЃћрЃџрЃА рЃБрЃерЃџрЃўрЃЊрЃљ рЃАрЃљрЃерЃБрЃљрЃџрЃЮрЃА рЃЊрЃљ рЃЋрЃљрЃарЃўрЃљрЃфрЃўрЃўрЃА рЃАрЃгрЃЮрЃа рЃњрЃљрЃюрЃљрЃгрЃўрЃџрЃћрЃЉрЃљрЃА, рЃ«рЃЮрЃџрЃЮ RobustScaler рЃБрЃЎрЃћрЃЌ рЃБрЃЏрЃЎрЃџрЃљрЃЋрЃЊрЃћрЃЉрЃљ рЃЏрЃљрЃЌ.

**Validation WMAE: 1648.15**
# 3. DLinear

##  рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљ

### Feature Engineering
- **рЃњрЃљрЃарЃћ рЃцрЃљрЃЦрЃбрЃЮрЃарЃћрЃЉрЃў:** Temperature, Fuel_Price, CPI, Unemployment
- **рЃЊрЃарЃЮрЃўрЃА рЃЏрЃљрЃ«рЃљрЃАрЃўрЃљрЃЌрЃћрЃЉрЃџрЃћрЃЉрЃў:** Week, Year
- **рЃљрЃарЃЊрЃљрЃЊрЃћрЃњрЃћрЃЉрЃўрЃА рЃЏрЃБрЃџрЃбрЃўрЃърЃџрЃўрЃЎрЃљрЃбрЃЮрЃарЃћрЃЉрЃў:** IsHoliday (5x рЃгрЃЮрЃюрЃљ WMAE-рЃерЃў)
- **MarkDown рЃцрЃљрЃЦрЃбрЃЮрЃарЃћрЃЉрЃў:** MarkDown1-5 (рЃцрЃљрЃАрЃЊрЃљрЃЎрЃџрЃћрЃЉрЃћрЃЉрЃў)

### Data Preprocessing
```python
# Log transformation for target variable
y_raw = np.log1p(store_df[target_col].values)

# StandardScaler for features
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X_raw)

# Forward fill for missing values
df = df.fillna(method='ffill')
```

### Data Splitting
- **Input Length:** 12 рЃЎрЃЋрЃўрЃарЃљ
- **Output Length:** 1 рЃЎрЃЋрЃўрЃарЃљ
- **Train/Val Split:** 80/20 (shuffle=False)
- **Store Focus:** Store 1 (рЃърЃўрЃџрЃЮрЃбрЃў)

##  DLinear рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ

### рЃарЃљрЃбрЃЮрЃЏ LSTM?
LSTM рЃљрЃўрЃарЃЕрЃљ рЃарЃљрЃЊрЃњрЃљрЃю:
- **Sequential Data:** рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў рЃЊрЃарЃЮрЃерЃў рЃЊрЃљрЃЏрЃЮрЃЎрЃўрЃЊрЃћрЃЉрЃБрЃџрЃўрЃљ
- **Long-term Dependencies:** рЃерЃЮрЃарЃћрЃБрЃџрЃў рЃЎрЃљрЃЋрЃерЃўрЃарЃћрЃЉрЃўрЃА рЃЊрЃљрЃЏрЃљрЃ«рЃАрЃЮрЃЋрЃарЃћрЃЉрЃљ
- **Vanishing Gradient:** LSTM рЃБрЃЏрЃЎрЃџрЃљрЃЋрЃЊрЃћрЃЉрЃљ gradient vanishing рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљрЃА
- **Memory Cells:** рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЋрЃљрЃюрЃў рЃўрЃюрЃцрЃЮрЃарЃЏрЃљрЃфрЃўрЃўрЃА рЃерЃћрЃюрЃљрЃ«рЃЋрЃљ

### рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ
```python
class LSTMForecaster(nn.Module):
    def __init__(self, n_features, hidden_dim=64, n_layers=2, output_len=1, dropout=0.2):
        self.lstm = nn.LSTM(
            input_size=n_features,
            hidden_size=hidden_dim,
            num_layers=n_layers,
            batch_first=True,
            dropout=dropout
        )
        self.fc = nn.Linear(hidden_dim, output_len)
```

**рЃЏрЃБрЃерЃљрЃЮрЃЉрЃўрЃА рЃърЃарЃўрЃюрЃфрЃўрЃърЃў:**
- **Input:** 12 рЃЎрЃЋрЃўрЃарЃўрЃА features (12, n_features)
- **LSTM Layers:** 2 рЃцрЃћрЃюрЃљ, 64 hidden units
- **Dropout:** 0.2 overfitting-рЃўрЃА рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃю рЃљрЃАрЃљрЃфрЃўрЃџрЃћрЃЉрЃџрЃљрЃЊ
- **Output:** 1 рЃЎрЃЋрЃўрЃарЃўрЃА рЃърЃарЃЮрЃњрЃюрЃЮрЃќрЃў

## ­ЪЊѕ рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ

### Sequence Creation
```python
def make_sequences(X, y, input_len=12, output_len=1):
    # Sliding window approach
    # Input: 12 weeks of features
    # Output: 1 week prediction
```

### рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃўрЃА рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў
```python
INPUT_LEN = 12          # 12 рЃЎрЃЋрЃўрЃарЃљ input
OUTPUT_LEN = 1          # 1 рЃЎрЃЋрЃўрЃарЃљ output
BATCH_SIZE = 32
LEARNING_RATE = 5e-4
EPOCHS = 30
```

### рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃўрЃА рЃърЃарЃЮрЃфрЃћрЃАрЃў
- **Loss Function:** L1Loss (MAE)
- **Optimizer:** Adam
- **Device:** CUDA (GPU)
- **Validation:** рЃДрЃЮрЃЋрЃћрЃџ epoch-рЃќрЃћ

## ­ЪЊі рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў

### рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃўрЃА рЃърЃарЃЮрЃњрЃарЃћрЃАрЃў
- **Epoch 1:** Train L1: 3.0910, Val L1: 1.3851
- **Epoch 10:** Train L1: 1.2996, Val L1: 1.3723
- **Epoch 20:** Train L1: 1.2988, Val L1: 1.3683
- **Epoch 30:** Train L1: 1.3002, Val L1: 1.3684

### WMAE рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃў
```python
# Store 1-рЃўрЃА рЃерЃћрЃЊрЃћрЃњрЃў
WMAE (Store 1): 18,232.87

# MLflow tracking-рЃерЃў
WMAE: 37,452,165.20 (рЃерЃћрЃАрЃљрЃФрЃџрЃЮрЃљ overfitting)
```

### рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃА рЃБрЃърЃўрЃарЃљрЃбрЃћрЃАрЃЮрЃЉрЃћрЃЉрЃў
- **Sequential Learning:** рЃЊрЃарЃЮрЃерЃў рЃЊрЃљрЃЏрЃЮрЃЎрЃўрЃЊрЃћрЃЉрЃБрЃџрЃћрЃЉрЃћрЃЉрЃўрЃА рЃЦрЃЏрЃюрЃљ
- **Feature Integration:** рЃЏрЃарЃљрЃЋрЃљрЃџрЃў рЃцрЃљрЃЦрЃбрЃЮрЃарЃўрЃА рЃњрЃљрЃЌрЃЋрЃљрЃџрЃўрЃАрЃгрЃўрЃюрЃћрЃЉрЃљ
- **Memory Efficient:** LSTM-рЃўрЃА рЃЏрЃћрЃ«рЃАрЃўрЃћрЃарЃћрЃЉрЃўрЃА рЃБрЃюрЃљрЃарЃў
- **Scalable:** рЃАрЃ«рЃЋрЃљ stores-рЃќрЃћ рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃљ

## ­ЪћЇ MLflow Tracking

```python
# рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃћрЃЉрЃўрЃА рЃџрЃЮрЃњрЃўрЃарЃћрЃЉрЃљ
mlflow.log_param("input_len", 12)
mlflow.log_param("output_len", 1)
mlflow.log_param("model_type", "DLinear")
mlflow.log_metric("WMAE", wmae)
```

##  рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃўрЃА рЃљрЃюрЃљрЃџрЃўрЃќрЃў

### рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃћрЃЉрЃў
- **Overfitting:** рЃЏрЃљрЃдрЃљрЃџрЃў WMAE MLflow-рЃерЃў
- **Store Specific:** рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ Store 1-рЃќрЃћ рЃбрЃћрЃАрЃбрЃўрЃарЃћрЃЉрЃљ
- **Feature Scaling:** log transformation рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃљрЃа рЃўрЃДрЃЮрЃА рЃЮрЃърЃбрЃўрЃЏрЃљрЃџрЃБрЃарЃў

### рЃњрЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃћрЃЉрЃћрЃЉрЃў
- **Multi-store Training:** рЃДрЃЋрЃћрЃџрЃљ store-рЃќрЃћ рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃў
- **Hyperparameter Tuning:** рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃА рЃЏрЃЮрЃФрЃўрЃћрЃЉрЃљ
- **Ensemble Methods:** рЃАрЃ«рЃЋрЃљ рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃЌрЃљрЃю рЃЎрЃЮрЃЏрЃЉрЃўрЃюрЃљрЃфрЃўрЃљ
