# finalProjectML
áƒ”áƒ¡ áƒžáƒ áƒáƒ”áƒ¥áƒ¢áƒ˜ áƒ›áƒ˜áƒ–áƒœáƒáƒ“ áƒ˜áƒ¡áƒáƒ®áƒáƒ•áƒ¡ áƒ¬áƒ˜áƒœáƒáƒ¡áƒ¬áƒáƒ áƒ›áƒ”áƒ¢áƒ§áƒ•áƒ”áƒšáƒ”áƒ‘áƒáƒ¡ áƒ›áƒáƒ¦áƒáƒ–áƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ§áƒáƒ•áƒ”áƒšáƒ™áƒ•áƒ˜áƒ áƒ”áƒ£áƒšáƒ˜ áƒ’áƒáƒ§áƒ˜áƒ“áƒ•áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒªáƒ£áƒšáƒáƒ‘áƒáƒ–áƒ”, â€žWalmart Recruiting - Store Sales Forecastingâ€œ áƒ™áƒáƒ’áƒšáƒ˜áƒ¡ áƒ™áƒáƒœáƒ™áƒ£áƒ áƒ¡áƒ˜áƒ¡ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ–áƒ” áƒ“áƒáƒ§áƒ áƒ“áƒœáƒáƒ‘áƒ˜áƒ—.
áƒ’áƒáƒ›áƒáƒ§áƒ”áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒáƒšáƒ’áƒáƒ áƒ˜áƒ—áƒ›áƒ”áƒ‘áƒ˜
DLinear, RandomForestRegressor, LightGBM, XGBOOST, N-BEATS, ARIMA, SARIMA
# 1. RANDOMFORESTREGRESSOR
 # áƒ¡áƒáƒ›áƒ£áƒ¨áƒáƒ áƒœáƒáƒ‘áƒ˜áƒ¯áƒ”áƒ‘áƒ˜
áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ¡ áƒ©áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ áƒ“áƒ áƒ’áƒáƒ¬áƒ›áƒ”áƒœáƒ“áƒ

áƒ©áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ£áƒšáƒ˜áƒ train.csv, test.csv, features.csv, stores.csv

áƒ’áƒáƒ”áƒ áƒ—áƒ˜áƒáƒœáƒ“áƒ áƒ§áƒ•áƒ”áƒšáƒ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ˜ Store áƒ“áƒ Date áƒ¡áƒ•áƒ”áƒ¢áƒ”áƒ‘áƒ–áƒ”

áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜áƒ“áƒáƒœ áƒ’áƒáƒ›áƒáƒ—áƒ•áƒšáƒ˜áƒšáƒ˜áƒ áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ—áƒ˜ áƒ¡áƒ•áƒ”áƒ¢áƒ”áƒ‘áƒ˜: Year, Month, Week

áƒªáƒáƒ áƒ˜áƒ”áƒšáƒ˜ áƒ›áƒœáƒ˜áƒ¨áƒ•áƒœáƒ”áƒšáƒáƒ‘áƒ”áƒ‘áƒ˜ (Markdown áƒªáƒ•áƒšáƒáƒ“áƒ”áƒ‘áƒ¨áƒ˜) áƒ©áƒáƒœáƒáƒªáƒ•áƒšáƒ“áƒ áƒœáƒ£áƒšáƒ”áƒ‘áƒ˜áƒ—

áƒ™áƒáƒ¢áƒ”áƒ’áƒáƒ áƒ˜áƒ£áƒšáƒ˜ áƒªáƒ•áƒšáƒáƒ“áƒ˜ Type áƒ’áƒáƒ“áƒáƒ™áƒ”áƒ—áƒ“áƒ áƒ áƒ˜áƒªáƒ®áƒ•áƒáƒ‘áƒ áƒ˜áƒ•áƒáƒ“ (LabelEncoder-áƒ˜áƒ—)

áƒ¢áƒ áƒ”áƒœáƒ˜áƒœáƒ’ áƒ•áƒáƒšáƒ˜áƒ“áƒáƒªáƒ˜áƒ˜áƒ¡ áƒ’áƒáƒ§áƒáƒ¤áƒ (Train-Test Split)

áƒ›áƒáƒ“áƒ”áƒšáƒ˜ áƒ’áƒáƒ¬áƒ•áƒ áƒ—áƒœáƒ˜áƒšáƒ˜áƒ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ¡ 80%-áƒ–áƒ”

áƒ¨áƒ”áƒ¤áƒáƒ¡áƒ”áƒ‘áƒ£áƒšáƒ˜áƒ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ¡ áƒ“áƒáƒ áƒ©áƒ”áƒœáƒ˜áƒš 20%-áƒ–áƒ”

áƒ¨áƒ”áƒ¤áƒáƒ¡áƒ”áƒ‘áƒ â€” WMAE (Weighted Mean Absolute Error)

áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ˜áƒ¡ áƒ“áƒáƒ—áƒ•áƒšáƒ áƒ˜áƒ—áƒ•áƒáƒšáƒ˜áƒ¡áƒ¬áƒ˜áƒœáƒ”áƒ‘áƒ¡ IsHoliday áƒ¡áƒ•áƒ”áƒ¢áƒ¡: áƒáƒ áƒ“áƒáƒ“áƒ”áƒ’áƒ”áƒ‘áƒ˜áƒ¡ áƒ™áƒ•áƒ˜áƒ áƒ”áƒ‘áƒ˜ 5-áƒ¯áƒ”áƒ  áƒ›áƒ”áƒ¢ áƒ¬áƒáƒœáƒáƒ¡ áƒ˜áƒ«áƒšáƒ”áƒ•áƒ

áƒ›áƒ˜áƒ¦áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ¨áƒ”áƒ¤áƒáƒ¡áƒ”áƒ‘áƒ áƒ’áƒ•áƒ˜áƒ©áƒ•áƒ”áƒœáƒ”áƒ‘áƒ¡, áƒ áƒáƒ›áƒ“áƒ”áƒœáƒáƒ“ áƒ™áƒáƒ áƒ’áƒáƒ“ áƒžáƒ áƒáƒ’áƒœáƒáƒ–áƒ˜áƒ áƒ”áƒ‘áƒ¡ áƒ›áƒáƒ“áƒ”áƒšáƒ˜ áƒ áƒ”áƒáƒšáƒ£áƒ  áƒ’áƒáƒ§áƒ˜áƒ“áƒ•áƒ”áƒ‘áƒ¡

# áƒ›áƒáƒ“áƒ”áƒšáƒ˜áƒ¡ áƒ’áƒáƒ“áƒáƒ›áƒ–áƒáƒ“áƒ”áƒ‘áƒ áƒ“áƒ áƒ¤áƒ˜áƒœáƒáƒšáƒ£áƒ áƒ˜ áƒžáƒ áƒáƒ’áƒœáƒáƒ–áƒ˜áƒ áƒ”áƒ‘áƒ

áƒ›áƒáƒ“áƒ”áƒšáƒ˜ áƒ’áƒáƒ“áƒáƒ›áƒ–áƒáƒ“áƒ“áƒ áƒ¡áƒ áƒ£áƒš train áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ–áƒ”

áƒžáƒ áƒáƒ’áƒœáƒáƒ–áƒ”áƒ‘áƒ˜ áƒ’áƒáƒ›áƒáƒ—áƒ•áƒšáƒ˜áƒšáƒ˜áƒ test.csv áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ–áƒ”

# áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ”áƒ‘áƒ˜
áƒ•áƒáƒšáƒ˜áƒ“áƒáƒªáƒ˜áƒáƒ–áƒ” áƒ›áƒ˜áƒ¦áƒ”áƒ‘áƒ£áƒšáƒ˜ WMAE áƒ’áƒ•áƒ˜áƒ©áƒ•áƒ”áƒœáƒ”áƒ‘áƒ¡ áƒ›áƒáƒ“áƒ”áƒšáƒ˜áƒ¡ áƒ¨áƒ”áƒ¡áƒáƒ«áƒšáƒ”áƒ‘áƒšáƒáƒ‘áƒ”áƒ‘áƒ¡ áƒ’áƒáƒ§áƒ˜áƒ“áƒ•áƒ”áƒ‘áƒ˜áƒ¡ áƒžáƒ áƒáƒ’áƒœáƒáƒ–áƒ˜áƒ áƒ”áƒ‘áƒáƒ¨áƒ˜.

Random Forest áƒ’áƒ—áƒáƒ•áƒáƒ–áƒáƒ‘áƒ— áƒ¡áƒ¢áƒáƒ‘áƒ˜áƒšáƒ£áƒ  áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ¡ áƒ áƒáƒ›áƒ“áƒ”áƒœáƒ˜áƒ›áƒ” áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ˜áƒ¡ áƒ’áƒáƒ›áƒáƒ§áƒ”áƒœáƒ”áƒ‘áƒ˜áƒ—, áƒ§áƒáƒ•áƒ”áƒšáƒ’áƒ•áƒáƒ áƒ˜ áƒ áƒ—áƒ£áƒšáƒ˜ áƒ¢áƒ˜áƒ£áƒœáƒ˜áƒœáƒ’áƒ˜áƒ¡ áƒ’áƒáƒ áƒ”áƒ¨áƒ”.

# 2.ARIMA
### Feature Engineering
- **áƒ“áƒ áƒáƒ˜áƒ¡ áƒ›áƒáƒ®áƒáƒ¡áƒ˜áƒáƒ—áƒ”áƒ‘áƒšáƒ”áƒ‘áƒ˜:** Month, Week, DayOfYear
- **Store-Department áƒ¡áƒ¢áƒáƒ¢áƒ˜áƒ¡áƒ¢áƒ˜áƒ™áƒ:** Sales_Mean, Sales_Std, Sales_Median, Sales_Min, Sales_Max
- **áƒ’áƒáƒ áƒ” áƒ¤áƒáƒ¥áƒ¢áƒáƒ áƒ”áƒ‘áƒ˜:** Temperature, Fuel_Price, CPI, Unemployment
- **áƒáƒ áƒ“áƒáƒ“áƒ”áƒ’áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ£áƒšáƒ¢áƒ˜áƒžáƒšáƒ˜áƒ™áƒáƒ¢áƒáƒ áƒ”áƒ‘áƒ˜:** Store-Department áƒ¡áƒžáƒ”áƒªáƒ˜áƒ¤áƒ˜áƒ£áƒšáƒ˜ áƒ“áƒ áƒ’áƒšáƒáƒ‘áƒáƒšáƒ£áƒ áƒ˜

### Data Splitting
- **Training:** 2010-02-05 to 2012-07-27
- **Validation:** 2012-08-03 to 2012-10-26 (13 áƒ™áƒ•áƒ˜áƒ áƒ)
- **Grouping:** Store-Department áƒ™áƒáƒ›áƒ‘áƒ˜áƒœáƒáƒªáƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—

## ðŸ“ˆ ARIMA áƒ›áƒáƒ“áƒ”áƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ˜áƒ›áƒžáƒšáƒ”áƒ›áƒ”áƒœáƒ¢áƒáƒªáƒ˜áƒ

### áƒ áƒáƒ¢áƒáƒ› ARIMA?
ARIMA áƒáƒ˜áƒ áƒ©áƒ áƒ áƒáƒ“áƒ’áƒáƒœ:
- **Time Series áƒ‘áƒ£áƒœáƒ”áƒ‘áƒ:** áƒ’áƒáƒ§áƒ˜áƒ“áƒ•áƒ”áƒ‘áƒ˜ áƒ“áƒ áƒáƒ¨áƒ˜ áƒ“áƒáƒ›áƒáƒ™áƒ˜áƒ“áƒ”áƒ‘áƒ£áƒšáƒ˜áƒ
- **Trend áƒ“áƒ Seasonality:** ARIMA áƒ£áƒ›áƒ™áƒšáƒáƒ•áƒ“áƒ”áƒ‘áƒ áƒ¢áƒ”áƒœáƒ“áƒ”áƒœáƒªáƒ˜áƒáƒ¡ áƒ“áƒ áƒ¡áƒ”áƒ–áƒáƒœáƒ£áƒ áƒáƒ‘áƒáƒ¡
- **áƒžáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ˜áƒœáƒ¢áƒ”áƒ áƒžáƒ áƒ”áƒ¢áƒáƒªáƒ˜áƒ:** p,d,q áƒžáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ”áƒ‘áƒ˜ áƒ›áƒáƒ áƒ¢áƒ˜áƒ•áƒáƒ“ áƒ’áƒáƒ¡áƒáƒ’áƒ”áƒ‘áƒ˜áƒ

### 1) Simple ARIMA (WMAE: 2213.76)
```python
# áƒ‘áƒáƒ–áƒ£áƒ áƒ˜ ARIMA(1,1,1) áƒ§áƒ•áƒ”áƒšáƒ Store-Dept-áƒ–áƒ”
model = ARIMA(ts, order=(1, 1, 1))
# áƒ’áƒšáƒáƒ‘áƒáƒšáƒ£áƒ áƒ˜ áƒáƒ áƒ“áƒáƒ“áƒ”áƒ’áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ£áƒšáƒ¢áƒ˜áƒžáƒšáƒ˜áƒ™áƒáƒ¢áƒáƒ áƒ˜: 1.074
```

**áƒ›áƒ£áƒ¨áƒáƒáƒ‘áƒ˜áƒ¡ áƒžáƒ áƒ˜áƒœáƒªáƒ˜áƒžáƒ˜:**
- áƒ›áƒ˜áƒœáƒ˜áƒ›áƒ£áƒ› 10 áƒ“áƒáƒ™áƒ•áƒ˜áƒ áƒ•áƒ”áƒ‘áƒ Store-Dept-áƒ–áƒ”
- Weekly aggregation
- Fallback: Store-Dept áƒ¡áƒáƒ¨áƒ£áƒáƒšáƒ

### 2) Optimized ARIMA (WMAE: 2550.43)
```python
# áƒ›áƒ áƒáƒ•áƒáƒšáƒ˜ ARIMA áƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒáƒªáƒ˜áƒ˜áƒ¡ áƒ¢áƒ”áƒ¡áƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ
configs = [(1,1,1), (2,1,1), (1,1,2), (0,1,1), (1,0,1), (2,1,2)]
# AIC-áƒ˜áƒ— áƒ¡áƒáƒ£áƒ™áƒ”áƒ—áƒ”áƒ¡áƒ áƒ›áƒáƒ“áƒ”áƒšáƒ˜áƒ¡ áƒáƒ áƒ©áƒ”áƒ•áƒ
```

**áƒ’áƒáƒ£áƒ›áƒ¯áƒáƒ‘áƒ”áƒ¡áƒ”áƒ‘áƒ”áƒ‘áƒ˜:**
- Store-Dept áƒ¡áƒžáƒ”áƒªáƒ˜áƒ¤áƒ˜áƒ£áƒšáƒ˜ áƒáƒ áƒ“áƒáƒ“áƒ”áƒ’áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ£áƒšáƒ¢áƒ˜áƒžáƒšáƒ˜áƒ™áƒáƒ¢áƒáƒ áƒ”áƒ‘áƒ˜
- áƒ¢áƒ”áƒ›áƒžáƒ”áƒ áƒáƒ¢áƒ£áƒ áƒ˜áƒ¡ áƒ™áƒáƒ áƒ”áƒ¥áƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ (>80Â°C: 0.95x, <30Â°C: 1.05x)
- áƒ›áƒ˜áƒœáƒ˜áƒ›áƒ£áƒ› 15 áƒ“áƒáƒ™áƒ•áƒ˜áƒ áƒ•áƒ”áƒ‘áƒ

### 3) Fast Optimized ARIMA (WMAE: 2152.64)
```python
# áƒ¨áƒ”áƒ›áƒªáƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ™áƒáƒœáƒ¤áƒ˜áƒ’áƒ£áƒ áƒáƒªáƒ˜áƒ”áƒ‘áƒ˜ áƒ¡áƒ¬áƒ áƒáƒ¤áƒ˜ áƒáƒžáƒ¢áƒ˜áƒ›áƒ˜áƒ–áƒáƒªáƒ˜áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡
configs = [(1,1,1), (2,1,1), (1,1,2)]
# áƒ¢áƒ”áƒ›áƒžáƒ”áƒ áƒáƒ¢áƒ£áƒ áƒ˜áƒ¡ áƒœáƒáƒ™áƒšáƒ”áƒ‘áƒ˜ áƒ’áƒáƒ•áƒšáƒ”áƒœáƒ (0.98x, 1.02x)
```

**áƒáƒžáƒ¢áƒ˜áƒ›áƒ˜áƒ–áƒáƒªáƒ˜áƒ”áƒ‘áƒ˜:**
- áƒ›áƒ˜áƒœáƒ˜áƒ›áƒ£áƒ› 12 áƒ“áƒáƒ™áƒ•áƒ˜áƒ áƒ•áƒ”áƒ‘áƒ
- 80% recent + 20% overall average fallback
- áƒ¡áƒ¬áƒ áƒáƒ¤áƒ˜ áƒžáƒ áƒáƒªáƒ”áƒ¡áƒ˜áƒœáƒ’áƒ˜

## ðŸŽ¯ WMAE áƒ›áƒ”áƒ¢áƒ áƒ˜áƒ™áƒ

```python
def compute_wmae(y_true, y_pred, is_holiday):
    weights = np.where(is_holiday, 5, 1)  # áƒáƒ áƒ“áƒáƒ“áƒ”áƒ’áƒ”áƒ‘áƒ–áƒ” 5x áƒ¬áƒáƒœáƒ
    return np.sum(weights * np.abs(y_true - y_pred)) / np.sum(weights)
```
